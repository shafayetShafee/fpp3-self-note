{"title":"Time Series Graphics","markdown":{"headingText":"Time Series Graphics","containsRefs":false,"markdown":"\n## tsibble objects\n\n```{r}\n#| message: false\n#| warning: false\n\nlibrary(fpp3)\n```\n\n\n```{r}\n#| results: markup\nolympic_running\n```\n\n- `[4Y]` => Its a every four year data\n- There are 14 time series based on the `Length` and `Sex` variable.\n\n```{r}\nPBS\n```\n\n```{r}\nPBS %>% \n  filter(ATC2 == 'A10') %>% \n  select(Month, Concession, Type, Cost)\n```\n\n> Note that the index variable `Month`, and the keys `Concession` and `Type`, would be returned even if they were not explicitly selected as they are required for a tsibble (to ensure each row contains a unique combination of keys and index).\n\n\n```{r}\nPBS %>% \n  filter(ATC2 == 'A10') %>% \n  select(Month, Concession, Type, Cost) %>% \n  summarize(total = sum(Cost))\n```\n\n\n```{r}\nPBS %>% \n  filter(ATC2 == 'A10') %>% \n  select(Month, Concession, Type, Cost) %>% \n  summarize(total = sum(Cost)) %>% \n  mutate(Cost = total / 1e6) -> a10\n```\n\n\n### Read a csv file and convert it to a tsibble \n\n```{r}\n#| message: false\nprison <- readr::read_csv(\"https://OTexts.com/fpp3/extrafiles/prison_population.csv\")\nhead(prison)\n```\n\n```{r}\nunique(prison$Date)\n```\n\n```{r}\nprison %>% \n  mutate(Quarter = yearquarter(Date)) %>% \n  select(-Date) %>% \n  as_tsibble(\n    key = c(State, Gender, Legal, Indigenous),\n    index = Quarter\n  ) -> prison\n```\n\n\n```{r}\n#| results: markup\n\nprison\n```\n\n### The seasonal period\n\n> Seasonal period: Number of observations before the seasonal pattern repeats. For quarterly, monthly, weekly data, the seasonal period is the number of obs in a year.\n\n> If the data is observed more than once per week, then there is often more than one seasonal pattern in the data. For example, data with daily observations might have weekly (period = 7) or annual (period = 365) seasonal patterns. Similarly, data that are observed every minute might have hourly (period = 60), daily (period = 24 x 60 = 1440), weekly (period = 7 x 24 x 60) and annual seasonality (period = 365 x 24 x 60).\n\n\n## Time plots\n\n```{r}\na10 %>% \n  autoplot(Cost) +\n  labs(\n    y = \"$ (Millions)\",\n    title = \"Australian anitdiabetic drug sales\"\n  )\n```\n\n## Seasonal plots\n\n```{r}\na10 %>% \n  gg_season(Cost, labels = \"both\")\n```\n\n### Multiple Seasonal Periods\n\n> Where the data has more than one seasonal pattern, the period argument can be used to select which seasonal plot is required.\n\n```{r}\nvic_elec %>% \n  gg_season(Demand, period = \"day\") \n```\n```{r}\nvic_elec %>% \n  gg_season(Demand, period = \"week\")\n```\n\n## Seasonal subseries plots\n\n```{r}\na10 %>% \n  gg_subseries(Cost)\n```\n\n```{r}\ntourism\n```\n\n```{r}\ntourism %>% \n  filter(Purpose == 'Holiday') %>% \n  group_by(State) %>% \n  summarize(Trips = sum(Trips)) -> holidays\n\nholidays\n```\n\n```{r}\nholidays %>% autoplot(Trips)\n```\n\n```{r}\n#| fig-height: 10\nholidays %>% \n  gg_season(Trips)\n```\n\n```{r}\n#| fig-height: 10\nholidays %>% \n  gg_subseries(Trips)\n```\n\n\n## Measuring Correlation Coefficient\n\n```{r}\n#| message: false\n#| fig-width: 10\ntourism %>% \n  group_by(State) %>% \n  summarise(Trips = sum(Trips)) %>% \n  pivot_wider(names_from = State, values_from = Trips) %>% \n  GGally::ggpairs(columns = 2:9)\n\n```\n\n\n## Lagged plots\n\n```{r}\naus_production %>% \n  filter(year(Quarter) >= 2000) %>% \n  autoplot(Beer)\n```\n\n```{r}\naus_production %>% \n  filter(year(Quarter) >= 2000) -> recent_production\n  \nrecent_production %>% gg_lag(Beer, geom = \"point\")\n```\n\n- Positive correlation at lag 4 and 8 => presence of strong seasonality.\n\n\n## Autocorrelation\n\n```{r}\nrecent_production %>% ACF(y = Beer, lag_max = 9)\n```\n\n```{r}\nrecent_production %>% \n  ACF(Beer) %>% \n  autoplot()\n```\n\n> So the ACF of a trended time series tends to have positive values that slowly decrease as the lags increase.\n\n> When data are seasonal, the autocorrelations will be larger for the seasonal lags (at multiples of the seasonal period) than for other lags\n\n```{r}\na10 %>% \n  ACF(Cost, lag_max = 48) %>% \n  autoplot() +\n  labs(\n    title = \"Trended and Seasonal\"\n  )\n```\n\n**White Noise**: Time series that show no autocorrelation is called white noise.","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"ch2.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.549","theme":"cosmo"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}